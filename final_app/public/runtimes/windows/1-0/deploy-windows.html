<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  
  <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300italic,400italic,400,600' rel='stylesheet' type='text/css'>
  <!-- Use title if it's in the page YAML frontmatter -->
  <title>
      Deploying PAS for Windows 2012R2 |
    Pivotal Docs
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="/stylesheets/all.css" rel="stylesheet" media="screen, print" />
  <link href="/stylesheets/print.css" rel="stylesheet" media="print" />
  <link href='/images/favicon.ico' rel='shortcut icon'>

  <script src="/javascripts/all.js"></script>
  
<script type="text/javascript">
  if (window.location.host === 'docs.pivotal.io') {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '']);
    _gaq.push(['_setDomainName', '']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
    })();
  }
</script>

<script type="text/javascript">
  var blackList = ['acceptance'];

  blackList.forEach(function(blackListedEnv) {
    if (document.URL.indexOf(blackListedEnv) > -1 && blackListedEnv != "") {
      $('head').append('<meta name="hashtag" content="PivotalMoment">');
    }
  });
</script>

<!-- CrazyEgg Tracking Script -->
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0055/2990.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

<!-- Munchkin Marketo Script -->
<script type="text/javascript">
  (function() {
    var didInit = false;

    function initMunchkin() {
      if (didInit === false) {
        didInit = true;
        Munchkin.init('625-IUJ-009');
      }
    }

    var s = document.createElement('script');
    s.type = 'text/javascript';
    s.async = true;
    s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
    s.onreadystatechange = function() {
      if (this.readyState == 'complete' || this.readyState == 'loaded') {
        initMunchkin();
      }
    };
    s.onload = initMunchkin;
    document.getElementsByTagName('head')[0].appendChild(s);
  })();
</script>

</head>

<body class="runtimes runtimes_windows runtimes_windows_1-0 runtimes_windows_1-0_deploy-windows has-subnav">

<div class="viewport">
  <div class='wrap'>
    <script type="text/javascript">
      document.domain = "";
    </script>

      <header class="global-header header header-layout js-bar-links">
    <a class="pivotal-logo" href="/">
    </a>
    <a href="/" class="global-header-title">
      <span class="title-deemph">Pivotal</span> Documentation
    </a>
    <div class="btn-menu" data-behavior="MenuMobile"></div>
    <div class="header-links">
      <div class="header-item">
        <a href=""></a>
      </div>
      <div class="header-item">
        <a href="http://support.pivotal.io" target="_blank">Support</a>
      </div>

      <div class="header-item embedded-searchbar">
          <form method="get" action="/search">
            <input name="q" placeholder="Search PAS for Windows v1.0" class="search-box" />
              <input type="hidden" name="product_name" value="PAS for Windows" />
              <input type="hidden" name="product_version" value="1.0"/>
          </form>
      </div>
      
    </div>
  </header>



    <div class="container">

      <!--googleoff: index-->
      <div id="sub-nav" class="js-sidenav nav-container" role="navigation">
  <a class="sidenav-title" data-behavior="SubMenuMobile">
    Doc Index
  </a>
  <div class="nav-content">
    <ul>

      <li class="has_submenu">
        <a href="/runtimes/windows/1-0/index.html">PAS for Windows</a>
      </li>        
    </ul>
  </div>
</div><!--end of sub-nav-->
      <!--googleon: index-->

      <main class="content content-layout" id="js-content" role="main">
        <a id="top"></a>
          <div class="local-header title-container">
    <div class="local-header version-info">
      LATEST VERSION: v1.0 - <a href="">CHANGELOG</a>
    </div>
    <div class="local-header local-title clearfix">
      <img src="/images/cloud_rings.png">
      <span class="local-header-title">PAS for Windows
      </span>
      <span class="local-header local-version header-dropdown">
        <a class="local-header header-dropdown-link">v1.0</a>
        <span class="local-header header-dropdown-content">
          <ul>
                <li>
                    <a href="https://docs.pivotal.io/runtimes/windows/0-8/deploy-windows.html">v0.8</a>
                </li>
          </ul>
        </span>
      </span>

      <!-- search was here -->
    </div>
    <div class="local-header local-header-links">
    </div>
  </div>

          <h1 class="title-container" >
    Deploying PAS for Windows 2012R2
  </h1>

          <div id="js-quick-links" >
            <div class="quick-links"><ul>
<li><a href="#reqs">Requirements</a></li>
<li><a href="#ert">Step 1: Confirm Elastic Runtime Settings</a></li>
<li><a href="#install">Step 2: Install the Tile</a></li>
<li><a href="#config">Step 3: Configure and Deploy the Tile</a></li>
<li><a href="#copy">Step 4: (Optional) Create More Tiles</a></li>
<li>
<a href="#isolation">Windows Cells in Isolation Segments</a><ul>
<li><a href="#replicate">Replicate a Tile</a></li>
<li><a href="#assign-isolation">Assign a Tile to an Isolation Segment</a></li>
</ul>
</li>
<li><a href="#antivirus">Configure Antivirus for Windows Cells</a></li>
</ul></div>
          </div>
        <div class="to-top" id="js-to-top">
          <a href="#top" title="back to top"></a>
        </div>
        <p><strong></strong></p>

<p>This topic describes how to install and configure the Pivotal Application Service (PAS) for Windows 2012R2 tile. The PAS for Windows 2012R2 tile installs Windows cells on your Pivotal Cloud Foundry (PCF) deployment.</p>

<h2 id="-requirements"><a id='reqs'></a> Requirements</h2>

<p>To install the PAS for Windows 2012R2 v1.12 tile, you must have Ops Manager v1.12.0 or later and Elastic Runtime v1.12.0 or later deployed to vSphere, Amazon Web Services (AWS), Google Cloud Platform (GCP), or Azure.</p>

<h2 id="-step-1:-confirm-elastic-runtime-settings"><a id='ert'></a> Step 1: Confirm Elastic Runtime Settings</h2>

<p>There are two settings in the Elastic Runtime tile that affect the Windows cells installed by the PAS for Windows 2012R2 tile. Configure these settings as desired:</p>

<ul>
<li>In the <strong>Networking</strong> section, if you select the <strong>Disable SSL certificate verification for this environment</strong> checkbox, SSL certificate verification is disabled for Windows cells.</li>
<li>In the <strong>System Logging</strong> section, if you configure an external syslog aggregator, logs are drained from Windows cells as well as non-Windows cells.</li>
</ul>

<h2 id="-step-2:-install-the-tile"><a id='install'></a> Step 2: Install the Tile</h2>

<ol>
<li><p>Download the product file from the <strong>Pivotal Application Service for Windows 2012R2</strong> section of <a href="https://network.pivotal.io/products/p-windows-runtime">Pivotal Network</a>.</p></li>
<li><p>Navigate to the Ops Manager Installation Dashboard and click <strong>Import a Product</strong> to upload the product file. </p></li>
<li><p>Click <strong>+</strong> under the uploaded <strong>PAS for Windows 2012R2</strong> tile to add it to your staging area.</p></li>
</ol>

<h2 id="-step-3:-configure-and-deploy-the-tile"><a id='config'></a> Step 3: Configure and Deploy the Tile</h2>

<ol>
<li><p>Click the newly added <strong>PAS for Windows 2012R2</strong> tile.</p>

<p><img src="images/pcf-windows-tile-orange-1-12.png" alt="Pcf windows tile orange 1 12" /></p></li>
<li><p>Click <strong>Assign AZs and Networks</strong> or <strong>Assign Networks</strong>. The name of the section varies depending on your IaaS.</p></li>
<li><p>Assign your AZs and networks and click <strong>Save</strong>.</p></li>
<li><p>Click <strong>VM Options</strong>. </p>

<p><img src="images/vm-options.png" alt="Vm options" /></p></li>
<li><p>Specify how you would like to manage the administrator password for your Windows VMs. The default option is to <strong>Use random administrator password</strong>.</p></li>
<li><p>(Optional) Select the <strong>BETA: Enable BOSH-native SSH support on all VMs</strong> checkbox to start the Microsoft beta port of the OpenSSH daemon on port 22 on all VMs. Users will be able to SSH onto Windows VMs with the <code>bosh ssh</code> command, and enter a CMD terminal as an administrator user. They can then run <code>powershell.exe</code> to start a PowerShell session.</p></li>
<li><p>(Optional) Select the <strong>Enable Remote Desktop Protocol</strong> checkbox to enable RDP connections to the Windows Cells.</p>

<p class="note"><strong>Note</strong>: This feature is beta and not considered production-ready.</p></li>
<li><p>(Optional) If you want all VMs to support connection through Remote Desktop Protocol (RDP), click <strong>Enable Remote Desktop Protocol</strong>. </p></li>
<li><p>(Optional) If you want to configure a Key Management Service (KMS) that your volume-licensed Windows cell can register with, perform the following steps:</p>

<ol>
<li>Click <strong>Enable</strong></li>
<li>For the <strong>Host</strong> field, enter the KMS hostname.</li>
<li>For the <strong>Port</strong> field, enter the port number. The default port number is <code>1688</code>.</li>
</ol>

<p><img src="images/enable-kms.png" alt="The enable KMS text fields: host and port" /></p></li>
<li><p>(Optional) If you want your PAS for Windows 2012R2 application workloads to be deployed to an isolation segment, perform the steps in <a href="#assign-isolation">Assign a Tile to an Isolation Segment</a> below.</p></li>
<li><p>(Optional) If an antivirus scanner runs on your VMs, configure the scanner to let the BOSH agent download and uncompress files. See <a href="#antivirus">Configure Antivirus for Windows Cells</a> for details.</p></li>
<li><p>(Optional) To configure Windows cells to send Windows Event logs to an external syslog server, click <strong>System Logging</strong> and perform the steps in the <a href="/runtimes/windows/1-0/windows-troubleshooting.html#syslog">Send Cell Logs to a Syslog Server</a> section.</p></li>
<li><p>Click <strong>Errands</strong>. Pivotal recommends that you set the <strong>Install HWC Buildpack Errand</strong> to <strong>On</strong>. This ensures that you receive the most up-to-date HWC Buildpack.</p>

<p><img src="images/errands-hwc.png" alt="Errands hwc" /></p></li>
<li><p>Click <strong>Resource Config</strong> and adjust the number and VM types of your Windows cells as needed. Ensure that all VMs have disk sizes that match the possible sizes listed in the <a href="/runtimes/windows/1-0/about-windows-stemcells.html#sizing">Root Disk Sizing</a> table. If you are deploying PAS for Windows 2012R2 on Azure, see the <a href="/runtimes/windows/1-0/azure-light-stemcell.html#req">Configure Resources</a> section of the <em>Deploying the Azure Light Stemcell</em> topic.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
<li><p>Click <strong>Stemcell</strong>. Record the stemcell version number required by the tile. </p>

<p><img src="images/pcf-windows-tile-stemcell.png" alt="Pcf windows tile stemcell" /></p></li>
<li><p>Retrieve the stemcell by following the steps below for your IaaS.</p>

<ul>
<li>For vSphere, you must create your own stemcell. For more information, see either <a href="/runtimes/windows/1-0/vsphere-stemcell-build.html">Creating a vSphere Stemcell Manually</a> or <a href="https://github.com/cloudfoundry-incubator/bosh-windows-stemcell-builder/wiki/Creating-a-vSphere-Stemcell-by-Hand">Creating a vSphere Stemcell by Hand</a>.</li>
<li>For AWS, GCP, and Azure, navigate to the <strong>Stemcells for PCF (Windows)</strong> page of <a href="https://network.pivotal.io/products/stemcells-windows-server">Pivotal Network</a>. For more information, see the <a href="/runtimes/windows/1-0/about-windows-stemcells.html#light-stemcells">Light Stemcells</a> section of the <em>Using Windows Stemcells</em> topic.</li>
</ul></li>
<li><p>Click <strong>Save</strong>.</p></li>
<li><p>Return to the Ops Manager Installation Dashboard and click <strong>Apply Changes</strong> to install the PAS for Windows 2012R2 tile.</p></li>
</ol>

<h2 id="-step-4:-(optional)-create-more-tiles"><a id='copy'></a> Step 4: (Optional) Create More Tiles</h2>

<p>If you want to run Windows cells in multiple isolation segments, you must create and configure additional PAS for Windows 2012R2 tiles. See <a href="#isolation">Windows Cells in Isolation Segments</a> below for how to do this.</p>

<h2 id="-windows-cells-in-isolation-segments"><a id='isolation'></a> Windows Cells in Isolation Segments</h2>

<p>Isolation segments are compartmentalized resource pools for Diego cells. The cells in one isolation segment share routing, computing, and logging resources with other cells in the same segment, and do not use resources from other isolation segments.</p>

<p>To run Windows cells in multiple isolation segments, you need to create and install multiple PAS for Windows 2012R2 tiles and configure each to run in a different isolation segment.</p>

<p>If the isolation segments do not already exist in the Cloud Controller Database (CCDB), you need to create them there.</p>

<p>See <a href="#replicate">Replicate a Tile</a> for how to create multiple copies of the PAS for Windows 2012R2 tile.</p>

<p>See <a href="#assign-isolation">Assign a Tile to an Isolation Segment</a> for how to associate a PAS for Windows 2012R2 tile with an isolation segment, so that its cells run in that segment. </p>

<p>See the <a href="https://docs.pivotal.io/pivotalcf/2-1/adminguide/isolation-segments.html#create-an-is">Create an Isolation Segment</a> section of the <em>Managing Isolation Segments</em> topic for how to add an isolation segment to the CCDB.</p>

<h3 id="-replicate-a-tile"><a id='replicate'></a> Replicate a Tile</h3>

<p>To make multiple copies of the <strong>PAS for Windows 2012R2</strong> tile that you can assign to different isolation segments, use the Replicator tool as follows:</p>

<ol>
<li><p>Download the Replicator tool from the <strong>PAS for Windows 2012R2</strong> section of <a href="https://network.pivotal.io/products/p-windows-runtime">Pivotal Network</a>.</p></li>
<li><p>Navigate to the directory where you downloaded the Replicator tool.</p></li>
<li><p>Replicate the tile:
<pre class="terminal">
./replicator \
    -name &quot;YOUR-NAME&quot; \
    -path /PATH/TO/ORIGINAL.pivotal \
    -output /PATH/TO/COPY.pivotal
</pre></p>

<p>Replace the values above with the following:</p>

<ul>
<li><code>YOUR-NAME</code>: Provide a unique name for the new PAS for Windows tile. The name must be ten characters or less and only contain alphanumeric characters, dashes, underscores, and spaces.</li>
<li><code>/PATH/TO/ORIGINAL</code>: Provide the absolute path to the original PAS for Windows tile you downloaded from Pivotal Network.</li>
<li><code>/PATH/TO/COPY</code>: Provide the absolute path for the copy of the PAS for Windows tile that the Replicator tool produces.</li>
</ul></li>
<li><p>Install and configure the Windows isolation segment, using the new <code>.pivotal</code> file and following the procedures in this topic, starting with the <strong>Import a Product</strong> step of <a href="#install">Step 2: Install the Tile</a>.</p></li>
</ol>

<h3 id="-assign-a-tile-to-an-isolation-segment"><a id='assign-isolation'></a> Assign a Tile to an Isolation Segment</h3>

<p>To assign a PAS for Windows 2012R2 tile to an isolation segment, perform the following steps:</p>

<ol>
<li><p>Open the <strong>Application Containers</strong> pane.</p>

<p><img src="images/app_containers_segment_name.png" alt="App containers segment name" /></p></li>
<li><p>Under <strong>Segment Name</strong>, enter the name for the isolation segment to associate the tile with. If you are creating a new isolation segment, ensure that this name is unique across your PCF deployment.</p></li>
<li><p>Click <strong>Save</strong>.</p></li>
<li><p>If you are creating a new isolation segment, follow the steps in the <a href="https://docs.pivotal.io/pivotalcf/2-1/adminguide/isolation-segments.html#create-an-is">Create an Isolation Segment</a> section of the <em>Managing Isolation Segments</em> topic to add the isolation segment to the CCDB.</p></li>
</ol>

<h2 id="-configure-antivirus-for-windows-cells"><a id='antivirus'></a> Configure Antivirus for Windows Cells</h2>

<p>Diego cell VMs routinely download and uncompress files, while antivirus scanners scan files once they are downloaded or uncompressed. When an antivirus scanner program runs in a directory that BOSH is actively downloading or compressing into, scanner actions can block BOSH processes and cause hard-to-debug “Access is denied” errors.</p>

<p>To prevent these errors, configure your antivirus scanner to disable <strong>on-access scanning</strong> for the following directories on your Windows cell:</p>

<ul>
<li><code>C:\bosh</code></li>
<li><code>C:\var\vcap</code></li>
<li><code>C:\containerizer</code></li>
</ul>

        <div><a id='repo-link' href='http://github.com/pivotal-cf/docs-pcf-windows2012r2/tree/master/docs-content/deploy-windows.html.md.erb'>Create a pull request or raise an issue on the source for this page in GitHub</a></div>

      </main>
    </div>
  </div>
</div>

<div id="scrim"></div>

<div class="container">
  <footer class="site-footer-links">
    <div class="copyright">
  <a href='https://pivotal.io/privacy-policy'>Privacy Policy</a> | 
  <a href='https://pivotal.io/terms-of-use'>Terms of Use</a><br/>
  <a href='/'>Pivotal Documentation</a>
  &copy; 2018 <a href='https://pivotal.io'>Pivotal Software</a>, Inc. All Rights Reserved.
</div>
<div class="support">
  Need help? <a href="http://support.pivotal.io" target="_blank">Visit Support</a>
</div>

  </footer>
</div><!--end of container-->

</body>
</html>
